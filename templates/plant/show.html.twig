{% extends 'base.html.twig' %}

{% block head %}
    <link rel="canonical" href="{{ path('plant_show',{'id':plant.id,'slug':plant.slug}) }}" />
{% endblock %}
{% block stylesheets %}
    <style>
        h2{
            color: #d4f1c4;
        }
        h3{
            background: #8ea937;
        }
        h4{
            background: #afa152;
        }
    </style>
{% endblock %}
{% block title %}{{ plant.LatinName }} - {{ plant.name }}{% endblock %}

{% block body %}

    <h1>{{ plant.LatinName }} - {{ plant.name }}</h1>
    {% if is_granted('ROLE_EDIT') %}<a href="{{ path('plant_edit',{'id':plant.id}) }}">üñäÔ∏è editer</a>{% endif %}
    {% if plant.Family %}
    <h2><a href="{{ path('plant_index',{'family':plant.Family.id}) }}">{{ plant.Family.Name }}</a></h2>
    {% else %}
        <h2 style="color: orange">Aucune famille sp√©cifi√©e</h2>
    {% endif %}
    <div class="grid has-gutter-l">
        <div >
            {#Biotope#}
            <h3>Biotope (environement) // secteurs du terrain</h3>
            <h4>Conditions p√©doclimatiques</h4>
            <div><b>R√©sistance au froid (rusticit√©) :</b> {{ plant.Rusticity }}¬∞C
                {% if plant.RusticityComment %}({{ plant.RusticityComment }}){% endif %}</div>
            <div><b>R√©sistance au sec :</b> <a href="{{ path('plant_index',{'drought_tolerance':plant.DroughtTolerance}) }}">{{ plant.DroughtTolerance | human('drought_tolerance') }}</a></div>
{#            <div><b>R√©sistance au vent :</b> <span style="color:red;">cette info n'existe pas dans la base de donn√©e initiale</span></div>#}
            <div><b>Exposition id√©ale :</b>
                {% if plant.InsolationsByIdeal(true) | length %}
                    {% for insolation in plant.InsolationsByIdeal(true) %}
                        <a href="{{ path('plant_index',{'insolation':insolation.insolation.id}) }}">{{ insolation.type | human('insolation')  }}</a>
                    {% endfor %}
                {% else %}
                    <span style="color: orange">Aucune exposition sp√©cifi√©e</span>
                {% endif %}
            </div>
            <div><b>Exposition possible :</b> {% for insolation in plant.InsolationsByIdeal(false) %}
                    <a href="{{ path('plant_index',{'insolation':insolation.insolation.id}) }}">{{ insolation.type | human('insolation')  }}</a>
                {% endfor %}</div>
            <div><b>Fertilit√© :</b> {% for humuse in plant.humuses %}
                    <a href="{{ path('plant_index',{'humuses':humuse.id}) }}">{{ humuse.quantity | human('humuses',false) }}</a>
                {% endfor %}</div>
            <div><b>Aeration du sol :</b> {% for soil in plant.soils %}
                    <a href="{{ path('plant_index',{'soils':soil.id}) }}">{{ soil.name | human('soils',false) }}</a>
                {% endfor %}</div>
            <div><b>Ph :</b> {% for ph in plant.phs %}<a href="{{ path('plant_index',{'ph':ph.id}) }}">{{ ph.name }}</a>,{% endfor %}</div>
            <div><b>Calcaire :</b> <a href="{{ path('plant_index',{'limestone':plant.limestone}) }}">{{ plant.limestone | human('limestone') }}</a></div>
            <h4>Milieu naturel et sub naturel</h4>
            <div><b>Origine :</b> {% if plant.NativePlace %}{{ plant.NativePlace }}{% else %}<i style="color: orange">non pr√©cis√©</i>{% endif %}</div>
            {% for family in families %}
                <h4>{{ family.name }}</h4>
                {% for child in family.children %}
                    <h5>{{ child.name }}</h5>
                    <ul>
                        {% for attribute in child.attributes %}
                            {% if plant.attributesByCode(attribute.code) | length %}
                            <li data-code="{{ attribute.code }}">
                                {% if attribute.typeNone %}
                                    <a href="{{ path('plant_index',{('a_' ~ attribute.code ):'1'}) }}">{{ attribute.name }}</a>
                                {% else %}
                                    {{ attribute.name }} :
{#                                    {% if plant.attributesByCode(attribute.code) | length > 1 or plant.attributesByCode(attribute.code).first.value is not null %} : {% endif %}#}
                                    {% for attribute_value in plant.attributesByCode(attribute.code) %}
                                        {% if attribute.typeUnique %}
                                            {{ attribute_value.value }}
                                        {% else %}
                                            {% if attribute_value.value is not null %}<a href="{{ path('plant_index',{('a_' ~ attribute.code ):attribute_value.id}) }}">{{ attribute_value.value }}</a>{% endif %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}


                            </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                {% endfor %}
            {% endfor %}
        </div>
        <div>
            <h3><b>Description</b></h3>
            <div><b>Strate</b> <a href="{{ path('plant_index',{'stratum':plant.stratum}) }}">{{ plant.stratum | human('stratum') }}</a></div>
            <h4><b>Mensuration</b></h4>
            <div><b>hauteur</b> {{ plant.Height }}m - <b>largeur</b> {{ plant.Width }}m </div>
            <h4>Forme</h4>
            <div><b>Port - tendance naturelle :</b> {% for ports in plant.NaturalPorts() %}
                    {% for port in ports.ports %}
                        <a href="{{ path('plant_index',{'port':port.id}) }}">{{ port.name }}</a>
                    {% endfor %}
                {% endfor %}</div>
            <div><b>Port - possible :</b> {% for ports in plant.getPossiblePorts(false) %}
                    {% for port in ports.ports %}
                        <a href="{{ path('plant_index',{'port':port.id}) }}">{{ port.name }}</a>
                    {% endfor %}        {% endfor %}</div>
            <div><b>Tendance racinaire</b> <a href="{{ path('plant_index',{'root':plant.root}) }}">{{ plant.root | human('root') }}</a></div>
            <div><b>Feuillage</b> <a href="{{ path('plant_index',{'foliage':plant.foliage}) }}">{{ plant.foliage | human('foliage') }}</a>
                <b>densit√©</b> <a href="{{ path('plant_index',{'leaf_density':plant.LeafDensity}) }}">{{ plant.LeafDensity | human('leaf_density') }}</a></div>
            {% if plant.images | length %}
                {% for image in plant.images %}
                    <img width="150px" src="/uploads/{{ image.name }}" alt="">
                {% endfor %}
            {% else %}
                <span style="color:orange;">Aucune image associ√©e</span>
            {% endif %}
            <h4>Cycle</h4>
            <div><b>Plante</b> <a href="{{ path('plant_index',{'life_cycle':plant.LifeCycle}) }}">{{ plant.LifeCycle | human('life_cycle') }}</a></div>
            <div>

                {% set myFlowerings = [] %}
                {% for flowering in plant.Flowerings %}
                    {% set myFlowerings = myFlowerings|merge([flowering.month]) %}
                {% endfor %}
                {% set myCrops = [] %}
                {% for crop in plant.Crops %}
                    {% set myCrops = myCrops|merge([crop.month]) %}
                {% endfor %}
                {% if myFlowerings | length or myCrops | length %}
                    <table>
                        <thead>
                        <tr>
                            <th></th>
                            <th>Jan</th>
                            <th>F√©v</th>
                            <th>Mar</th>
                            <th>Avr</th>
                            <th>Mai</th>
                            <th>Juin</th>
                            <th>Juil</th>
                            <th>Aout</th>
                            <th>Sept</th>
                            <th>Oct</th>
                            <th>Nov</th>
                            <th>D√©c</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Floraison</td>
                            {% for m in 1..12 %}
                                <td>
                                    {% if m in myFlowerings %}<a href="{{ path('plant_index',{'flowerings':m}) }}">üåº</a>{% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                        <tr>
                            <td>Fructif</td>
                            {% for m in 1..12 %}
                                <td>
                                    {% if m in myCrops %}<a href="{{ path('plant_index',{'crops':m}) }}">üçé</a>{% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                        </tbody>
                    </table>
                {% endif %}
            </div>
            {% if plant.sources | length %}
                <h3>Sources</h3>
                <div>
                    <ul>
                        {% for source in plant.sources %}
                            <li>{{ source.name | autolink | raw }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
    </div>

{% endblock %}
